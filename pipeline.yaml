parameters:
  - name: imageName
    type: string
  - name: imageTag
    type: string
  - name: dockerFile
    type: string

steps:
  - task: Docker@2
    displayName: Build image
    inputs:
      repository: ${{ parameters.imageName }}
      command: build
      Dockerfile: ${{ parameters.dockerFile }}
      tags: |
        ${{ parameters.imageTag }}
      arguments: --build-arg BASE_IMAGE_TAG=${{ parameters.imageTag }}
  - task: Docker@2
    displayName: Push image
    inputs:
      containerRegistry: 'Edgeworx GCP'
      repository: ${{ parameters.imageName }}
      command: push
      Dockerfile: ${{ parameters.dockerFile }}
      tags: |
        ${{ parameters.imageTag }}
